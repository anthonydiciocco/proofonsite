# üåç Internationalisation (i18n) - ProofOnSite

## Vue d'ensemble

ProofOnSite utilise **@nuxtjs/i18n** pour prendre en charge plusieurs langues avec une exp√©rience utilisateur optimale.

## Langues support√©es

| Code | Langue | ISO |
|------|--------|-----|
| `en` | English | en-US |
| `fr` | Fran√ßais | fr-CA |
| `es` | Espa√±ol | es-ES |
| `zh` | ‰∏≠Êñá | zh-CN |
| `de` | Deutsch | de-DE |
| `pt` | Portugu√™s | pt-BR |

## Structure des fichiers

```
locales/
‚îú‚îÄ‚îÄ en.json      # Anglais (langue par d√©faut)
‚îú‚îÄ‚îÄ fr.json      # Fran√ßais
‚îú‚îÄ‚îÄ es.json      # Espagnol
‚îú‚îÄ‚îÄ zh.json      # Chinois simplifi√©
‚îú‚îÄ‚îÄ de.json      # Allemand
‚îî‚îÄ‚îÄ pt.json      # Portugais
```

## Configuration

### nuxt.config.ts
```typescript
i18n: {
  locales: [
    { code: 'en', name: 'English', file: 'en.json', iso: 'en-US' },
    { code: 'fr', name: 'Fran√ßais', file: 'fr.json', iso: 'fr-CA' },
    // ...
  ],
  lazy: true,                    // Chargement paresseux des traductions
  langDir: 'locales',
  defaultLocale: 'en',
  strategy: 'prefix_except_default',  // Routes: /fr/dashboard, /dashboard (en)
  detectBrowserLanguage: {
    useCookie: true,
    cookieKey: 'i18n_locale',
    redirectOn: 'root',
    alwaysRedirect: false,
    fallbackLocale: 'en'
  }
}
```

## Utilisation dans les composants

### Template (SFC)
```vue
<template>
  <div>
    <h1>{{ $t('hero.title') }}</h1>
    <p>{{ $t('hero.description') }}</p>
    <UButton>{{ $t('common.submit') }}</UButton>
  </div>
</template>
```

### Script Setup
```vue
<script setup lang="ts">
const { t } = useI18n()

const title = computed(() => t('hero.title'))
</script>
```

### Avec param√®tres
```vue
<template>
  <p>{{ $t('dashboard.greeting', { name: userName }) }}</p>
</template>
```

### Pluralisation
```json
{
  "sites": "0 sites | 1 site | {count} sites"
}
```

```vue
<template>
  <p>{{ $t('sites', { count: siteCount }, siteCount) }}</p>
</template>
```

## Composant Language Switcher

Un composant `<LanguageSwitcher />` est disponible pour changer de langue :

```vue
<template>
  <LanguageSwitcher />
</template>
```

Il affiche automatiquement :
- La langue actuelle
- Un menu d√©roulant avec toutes les langues disponibles
- Ic√¥ne globe
- Persistance du choix dans un cookie

## Routes localis√©es

### Strat√©gie `prefix_except_default`
- Langue par d√©faut (en) : `/dashboard`, `/login`
- Autres langues : `/fr/dashboard`, `/es/login`

### Navigation
```vue
<template>
  <!-- Lien localis√© automatique -->
  <NuxtLink :to="localePath('/dashboard')">
    {{ $t('nav.dashboard') }}
  </NuxtLink>

  <!-- Changer de langue -->
  <UButton @click="switchLocalePath('fr')">
    Fran√ßais
  </UButton>
</template>
```

## D√©tection automatique

Le module d√©tecte automatiquement :
1. **Cookie `i18n_locale`** (priorit√© la plus haute)
2. **Header `Accept-Language`** du navigateur
3. **Langue par d√©faut** (en) si aucune correspondance

## Ajout d'une nouvelle langue

### 1. Cr√©er le fichier de traduction
```bash
touch locales/it.json
```

### 2. Ajouter la configuration
```typescript
// nuxt.config.ts
i18n: {
  locales: [
    // ...autres langues
    { code: 'it', name: 'Italiano', file: 'it.json', iso: 'it-IT' }
  ]
}
```

### 3. Traduire le contenu
Copiez `en.json` et traduisez toutes les cl√©s.

## Structure JSON recommand√©e

```json
{
  "common": {
    "loading": "...",
    "error": "...",
    "success": "..."
  },
  "nav": {
    "home": "...",
    "dashboard": "..."
  },
  "auth": {
    "login": {
      "title": "...",
      "email": {
        "label": "...",
        "placeholder": "..."
      }
    }
  }
}
```

**Bonnes pratiques** :
- Groupez les traductions par domaine fonctionnel
- Utilisez des cl√©s descriptives (`auth.login.email.label`)
- √âvitez les cl√©s trop g√©n√©riques (`button1`, `text2`)
- Maintenez une structure coh√©rente entre toutes les langues

## SEO et m√©tadonn√©es

```vue
<script setup>
const { t } = useI18n()

useHead({
  title: t('meta.home.title'),
  meta: [
    {
      name: 'description',
      content: t('meta.home.description')
    }
  ]
})
</script>
```

## Traductions c√¥t√© serveur

```typescript
// server/api/example.ts
import { useI18n } from 'vue-i18n'

export default defineEventHandler(async (event) => {
  const { t, locale } = useI18n()

  return {
    message: t('common.success')
  }
})
```

## Traductions dans Nuxt UI

Les composants Nuxt UI utilisent leurs propres traductions. Pour les personnaliser :

```typescript
// nuxt.config.ts
export default defineNuxtConfig({
  ui: {
    notifications: {
      position: 'top-right'
    }
  }
})
```

Puis utilisez les traductions dans vos toasts :
```typescript
toast.add({
  title: t('common.success'),
  description: t('dashboard.sites.toast.created'),
  icon: 'i-lucide-check-circle'
})
```

## Tests

```typescript
import { describe, it, expect } from 'vitest'
import { useI18n } from 'vue-i18n'

describe('i18n', () => {
  it('should translate keys', () => {
    const { t } = useI18n()
    expect(t('common.loading')).toBe('Loading...')
  })
})
```

## Performance

- ‚úÖ **Lazy loading** : Les fichiers de traduction sont charg√©s √† la demande
- ‚úÖ **Code splitting** : Chaque langue est un chunk s√©par√©
- ‚úÖ **Cache** : Les traductions sont mises en cache c√¥t√© client
- ‚úÖ **SSR** : Les traductions fonctionnent avec le rendu serveur

## Ressources

- [Documentation Nuxt i18n](https://i18n.nuxtjs.org/)
- [Vue i18n](https://vue-i18n.intlify.dev/)
- [ISO Language Codes](https://en.wikipedia.org/wiki/List_of_ISO_639-1_codes)
- [Nuxt UI Documentation](https://ui.nuxt.com/)

## Contribution

Pour ajouter ou am√©liorer des traductions :
1. Fork le repo
2. Cr√©er une branche (`git checkout -b feat/add-italian`)
3. Modifier/ajouter les fichiers de traduction
4. Commit (`git commit -m 'Add Italian translations'`)
5. Push et cr√©er une Pull Request

---

**Note** : Les traductions pour le chinois, l'allemand et le portugais sont actuellement simplifi√©es. Des contributions natives sont les bienvenues pour am√©liorer la qualit√© des traductions.
